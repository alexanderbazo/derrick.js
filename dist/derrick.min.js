!function(){"use strict";var a={};window.Derrick=a}(),function(){"use strict";var a,b="PATTERN_DETECTED",c=[],d=function(b){a.postMessage({cmd:"addEvent",event:{id:b,at:(new Date).getTime()}})},e=function(a,b,c){a.addEventListener(b,function(){d(c)})},f=function(a){var d=a.data;switch(d.type){case b:c[d.id]({pattern:d.id})}},g=function(b){var c=window.location.pathname,d=c.substr(0,c.lastIndexOf("/"));a=new Worker(d+b),a.addEventListener("message",f),a.postMessage({cmd:"start"})},h=function(b,d,e,f){a.postMessage({cmd:"addPattern",pattern:{id:b,events:d,frame:void 0===f?-1:f}}),c[b]=e},i=function(b){a.postMessage({cmd:"removePattern",pattern:{id:b}}),delete c[b]},j=function(){var a;Element.prototype.addTriggerLink=function(a,b){e(this,a,b)},NodeList.prototype.addTriggerLink=function(b,c){for(a=0;a<this.length;a+=1)e(this[a],b,c)}};Derrick.start=g,Derrick.trigger=d,Derrick.addPatternListener=h,Derrick.removePatternListener=i,j()}();