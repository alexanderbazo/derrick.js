!function(){"use strict";var a=1e3,b="PATTERN_DETECTED",c=[],d=[],e=function(){c.length>a&&c.shift()},f=function(a,b){var d,e=b-1,f=null;for(d=e;d>=0;d-=1)if(f=c[d],f.id===a)return d;return-1},g=function(a){var d,e,g=[],h=a.events,i=-1,j=0,k=-1;if(!(c.length<h.length)&&c[c.length-1].id===h[h.length-1]){for(i=c.length-1,g.push(i),d=h.length-2;d>=0;d-=1){if(j=f(h[d],i),-1===j)return;g.push(j),i=j}k=c[g[0]].at-c[g[g.length-1]].at,e=k<=a.frame||-1===a.frame,e&&self.postMessage({type:b,id:a.id})}},h=function(){d.forEach(g)},i=function(a){c.push(a),e(),h()},j=function(a){d.push(a)},k=function(a){var b;for(b=0;b<d.length;b+=1)if(d[b].id===a.id)return void d.splice(b,1)},l=function(){c=[]},m=function(){d=[]};self.addEventListener("message",function(a){var b=a.data;switch(b.cmd){case"start":break;case"flush":l();break;case"clear":m();break;case"addEvent":i(b.event);break;case"addPattern":j(b.pattern);break;case"removePattern":k(b.pattern);break;default:self.postMessage("Unknown command: "+b.msg)}},!1)}();